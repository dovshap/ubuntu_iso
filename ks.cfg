#Generated by Kickstart Configurator
#platform=AMD64 or Intel EM64T


#System language
lang en_US
#Language modules to install
langsupport en_US
#System keyboard
keyboard us
#System mouse
mouse
#System timezone
timezone --utc America/Los_Angeles
#Root password
rootpw --disabled
#Initial user
user packer --fullname "packer test" --iscrypted --password $1$AeSgi/Hj$3.wAC4inm9q1/TZ5.yIeK1
#Reboot after installation
reboot
#Use text mode install
text
#Install OS instead of upgrade
install
#Use CDROM installation media
cdrom
#Unmount partitions that are in use
preseed partman/filter_mounted boolean false
preseed partman/unmount_active boolean true

#System bootloader configuration
bootloader --location=mbr 
#Clear the Master Boot Record
zerombr yes
#Partition clearing information
clearpart --all --initlabel
#Disk partitioning information
#part swap --size 256 --asprimary 
#part / --fstype ext4 --size 1 --grow --asprimary 
#part swap --size 256 --asprimary
part pv.01 --size 1 --grow --asprimary
volgroup rootvg pv.01
logvol swap --vgname=rootvg --size 256 --name=swap
logvol / --fstype ext4 --vgname=rootvg --size=1 --grow --name=rootvol

# needed to answer the 'do you want to write changes to disk"
preseed partman-lvm/confirm_nooverwrite boolean true

# needed to answer the question about not having a separate /boot
preseed partman-auto-lvm/no_boot boolean true
#System authorization infomation
auth  --useshadow  --enablemd5 
#Network information
network --bootproto=dhcp --device=eth0
#Firewall configuration
firewall --disabled 
#Do not configure the X Window System
skipx


%pre
/bin/dd if=/dev/zero of=/dev/sda bs=512 count=1
#parted -s /dev/sda mklabel msdos
%end

%post
apt-get update
apt-get upgrade -qqy
#Upgrade Kernel. Note this is required so the headers will match the kernel version
apt-get install -qqy linux-image-virtual linux-virtual
#Now we install the kernel headers so they match the new kernel version. Headers are not included in default virtual build.
apt-get install -qqy linux-headers-virtual
apt-get install -qqy screen
apt-get install -qqy ssh
apt-get install -qqy --force-yes ansible
apt-get install -qqy --force-yes openssh-server
apt-get install -qqy nano
#Kernel headers are required before we install Vmware Tools
apt-get install -qqy --no-install-recommends open-vm-dkms
apt-get install -qqy --no-install-recommends open-vm-tools
# Clean up packages
apt-get clean
%end
